onefile = F)
pheatmap(lab15, cellwidth = 20,
cellheight = 20,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
dev.off()
}
lab15[5,14] <- 0
pheatmap(lab15, cellwidth = 20,
cellheight = 20,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
lab15[7,2] <- 0
pheatmap(lab15, cellwidth = 20,
cellheight = 20,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
lab15[4,5] <- 0
pheatmap(lab15, cellwidth = 20,
cellheight = 20,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
lab15[9,7] <- 0
pheatmap(lab15, cellwidth = 20,
cellheight = 20,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
lab15[12,6] <- 0
pheatmap(lab15, cellwidth = 20,
cellheight = 20,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
lab15[14,7] <- 0
pheatmap(lab15, cellwidth = 20,
cellheight = 20,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
lab15[15:16,14:15] <- 1
pheatmap(lab15, cellwidth = 20,
cellheight = 20,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
lab15[12:13,13] <- 0
pheatmap(lab15, cellwidth = 20,
cellheight = 20,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
lab15[14,3] <- 0
pheatmap(lab15, cellwidth = 20,
cellheight = 20,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
lab15[8:11,13] <- 0
pheatmap(lab15, cellwidth = 20,
cellheight = 20,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
lab15[11,12] <- 0
pheatmap(lab15, cellwidth = 20,
cellheight = 20,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
lab15[7,11] <- 0
pheatmap(lab15, cellwidth = 20,
cellheight = 20,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
lab15[4,9] <- 0
pheatmap(lab15, cellwidth = 20,
cellheight = 20,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
lab15[4,16] <- 1
pheatmap(lab15, cellwidth = 20,
cellheight = 20,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
lab15[14,14] <- 0
pheatmap(lab15, cellwidth = 20,
cellheight = 20,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
lab15[11,15] <- 0
pheatmap(lab15, cellwidth = 20,
cellheight = 20,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
# You can save the labyrinth as .pdf file
{
pdf(file = "lab15.pdf",
width=6,
height=6,
paper='a4',
pagecentre = T,
onefile = F)
pheatmap(lab15, cellwidth = 20,
cellheight = 20,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
dev.off()
}
lab15[15,2] <- 0
lab15[16,3] <- 0
pheatmap(lab15, cellwidth = 20,
cellheight = 20,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
pdf(file = "lab15.pdf",
width=6,
height=6,
paper='a4',
pagecentre = T,
onefile = F)
# You can save the labyrinth as .pdf file
{
pdf(file = "lab15.pdf",
width=6,
height=6,
paper='a4',
pagecentre = T,
onefile = F)
pheatmap(lab15, cellwidth = 20,
cellheight = 20,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
dev.off()
}
lab15
lab_v_15 <- vector(length = 17*17)
lab_v_15
lab_v_15 <- lab15
lab_v_15
dim(lab_v_15)
dim(lab_v_15) <- 17*17
lab_v_15
lab15_v <- c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,0,0,0,0,1,1,1,0,1,0,0,0,1,1,0,0,0,1,1,0,0,1,1,1,0,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,1,1,1,0,1,0,1,1,0,0,0,0,0,0,1,1,1,1,1,1,0,1,1,1,1,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,1,1,0,1,0,1,0,1,0,0,0,1,1,1,0,1,1,1,1,0,1,1,1,0,0,0,1,1,1,1,1,0,1,0,1,1,0,0,0,1,1,0,1,0,1,0,0,0,0,0,0,1,1,0,1,0,0,1,0,1,1,1,0,0,1,1,0,1,1,1,0,1,0,1,1,0,0,0,1,0,1,1,0,1,1,1,1,0,0,1,0,0,1,1,1,1,0,1,1,0,0,1,1,1,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,1,1,0,0,1,0,0,0,1,1,1,0,0,1,0,1,1,1,1,1,0,0,0,1,1,1,1,0,0,1,0,0,1,1,1,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)
length(lab15_v)
17*17
lab15b <- matrix(data=lab15_v, nrow = 17, ncol = 17)
lab15b
pheatmap(lab15b, cellwidth = 20,
cellheight = 20,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
labi_size <- as.integer(readline(prompt = "Podaj rozmiar labiryntu:"))
{
lab_x <- generate_lab(labi_size);
lab_x[nrow(lab_x),ncol(lab_x)] <- 0;
lab_x[1,1] <- 0;
lab_xx = matrix(data = 1,
nrow = lab_size + 2,
ncol = lab_size + 2);
lab_xx[2:(lab_size+1),2:(lab_size+1)] <- lab_x
}
{
lab_x <- generate_lab(labi_size);
lab_x[nrow(lab_x),ncol(lab_x)] <- 0;
lab_x[1,1] <- 0;
lab_xx = matrix(data = 1,
nrow = labi_size + 2,
ncol = labi_size + 2);
lab_xx[2:(labi_size+1),2:(labi_size+1)] <- lab_x
}
dim(lab_xx)
dim(lab_xx)[1]
dim(lab_xx)[2]
lab20 <- lab_xx
lab20
dim(lab20)
pheatmap(lab_xx, cellwidth = 20,
cellheight = 20,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
pheatmap(lab_xx, cellwidth = 10,
cellheight = 10,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
pheatmap(lab_xx, cellwidth = 15,
cellheight = 15,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
#lab_xx to vector
labxx_v <- (dim(lab_xx) <- (dim(lab_xx)[1]*dim(lab_xx)[2]))
length(labxx_v)
lab20 <- lab_xx
dim(lab20)
lab_xx
labxx_v
labxx_v
rm(labxx_v)
pheatmap(lab_xx, cellwidth = 15,
cellheight = 15,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
dim(lab_xx) <- c(22,22)
pheatmap(lab_xx, cellwidth = 15,
cellheight = 15,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
lab_xx[4,3] <- 0
pheatmap(lab_xx, cellwidth = 15,
cellheight = 15,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
lab_xx[10,7] <- 0
pheatmap(lab_xx, cellwidth = 15,
cellheight = 15,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
lab_xx[11:14,11] <- 0
pheatmap(lab_xx, cellwidth = 15,
cellheight = 15,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
lab_xx[7,11:21] <- 0
pheatmap(lab_xx, cellwidth = 15,
cellheight = 15,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
lab_xx[7,4] <- 0
pheatmap(lab_xx, cellwidth = 15,
cellheight = 15,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
lab_xx[11,3] <- 0
pheatmap(lab_xx, cellwidth = 15,
cellheight = 15,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
lab_xx[9,18] <- 0
pheatmap(lab_xx, cellwidth = 15,
cellheight = 15,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
lab_xx[15,6] <- 0
pheatmap(lab_xx, cellwidth = 15,
cellheight = 15,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
lab_xx[18,19] <- 0
pheatmap(lab_xx, cellwidth = 15,
cellheight = 15,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
lab_xx[14,17] <- 0
pheatmap(lab_xx, cellwidth = 15,
cellheight = 15,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
lab_xx[8:10,20] <- 0
pheatmap(lab_xx, cellwidth = 15,
cellheight = 15,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
lab_xx[16,14] <- 0
pheatmap(lab_xx, cellwidth = 15,
cellheight = 15,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
lab_xx[12,17] <- 0
pheatmap(lab_xx, cellwidth = 15,
cellheight = 15,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
lab_xx[14,19] <- 0
pheatmap(lab_xx, cellwidth = 15,
cellheight = 15,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
lab_xx[15,19] <- 0
pheatmap(lab_xx, cellwidth = 15,
cellheight = 15,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
pheatmap(lab_xx, cellwidth = 15,
cellheight = 15,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
# You can save the labyrinth as .pdf file
{
pdf(file = "lab_20.pdf",
width=7,
height=7,
paper='a4',
pagecentre = T,
onefile = F)
pheatmap(lab_xx, cellwidth = 15,
cellheight = 15,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
dev.off()
}
lab20 <- lab_xx
dim(lab20)
dim(lab_xx) <- 22*22
dim(lab_xx)
lab_xx
lab20 <- c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,0,0,0,1,0,0,1,0,1,1,1,1,0,0,1,1,1,0,0,0,1,1,0,0,0,0,0,0,0,1,1,1,1,0,0,1,0,1,1,1,1,0,0,0,0,0,1,1,1,0,0,1,0,0,0,0,0,0,0,1,1,0,1,1,1,0,1,1,1,1,1,0,0,1,0,0,0,1,0,0,1,1,1,1,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,1,1,0,0,0,0,1,1,0,0,1,1,1,0,1,1,1,1,1,0,0,0,0,1,1,1,1,1,0,0,0,0,1,0,1,1,1,1,1,0,0,0,1,0,0,0,0,0,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,1,1,0,1,0,0,0,1,0,1,1,0,1,1,1,1,1,0,1,1,1,0,0,0,1,0,0,1,0,0,0,0,0,0,1,1,1,0,1,0,1,1,1,0,1,0,1,0,1,0,1,1,0,1,1,0,1,1,0,1,1,0,1,1,1,0,0,0,0,0,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,1,1,0,1,1,1,0,0,1,0,0,0,1,1,0,0,0,0,0,1,0,1,1,0,1,0,1,1,0,1,0,1,0,0,0,1,1,1,1,1,1,0,1,1,1,0,0,0,1,1,0,1,1,0,0,1,0,1,1,1,0,0,0,1,0,1,1,1,0,1,0,0,0,1,1,0,0,0,0,0,0,0,1,1,0,1,1,1,1,0,1,0,0,0,0,0,0,0,0,1,1,1,1,0,1,1,0,0,1,1,1,1,1,0,1,1,0,1,1,1,1,0,0,0,0,0,0,0,0,0,1,1,1,0,1,1,0,1,0,0,0,0,1,0,0,1,1,0,1,0,1,1,1,1,1,1,1,1,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)
dim(lab20)
lab20
dim(lab20)
dim(lab20) <- c(22,22)
lab20
lab20
dim(lab_xx)
labyrinth <- lab20
pheatmap(labyrinth, cellwidth = 15,
cellheight = 15,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
labyrinth <- lab15
pheatmap(labyrinth, cellwidth = 15,
cellheight = 15,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
labyrinth <- lab15
# set the variable for the size of choosen labyrinth
lab_size <- nrow(labyrinth) - 2; lab_size
evaluate3 <- function(string=c()) {
x <- 2;
y <- 2;
exit_coordinates <- lab_size * 2 + 2;
returnVal3 <- exit_coordinates;
for(step in 1:40) { if (x==11 & y==11) { returnVal2 = 0; break
} else if (round(string[step],0)==1 & labyrinth[x-1,y]==0) { x <- (x - 1)
} else if (round(string[step],0)==2 & labyrinth[x+1,y]==0) { x <- (x + 1)
} else if (round(string[step],0)==3 & labyrinth[x,y+1]==0) { y <- (y + 1)
} else if (round(string[step],0)==4 & labyrinth[x,y-1]==0) { y <- (y - 1)
} else next
}
returnVal3 <- (exit_coordinates - x - y);
returnVal3
}
vMin <- rep(0.51, lab_size * 4); vMax <- rep(4.49, lab_size * 4)
library(genalg)
genalg4_labyrinth <- rbga(stringMin=vMin, stringMax=vMax,
suggestions=NULL,
popSize=lab_size*10, iters=lab_size*10,
mutationChance=0.1,
elitism=T,
monitorFunc=NULL, evalFunc=evaluate3,
showSettings=FALSE, verbose=FALSE)
summary(genalg4_labyrinth, echo=T)
plot(genalg4_labyrinth)
genalg4_labyrinth$best
genalg4_labyrinth <- rbga(stringMin=vMin, stringMax=vMax,
suggestions=NULL,
popSize=lab_size*10, iters=lab_size*20,
mutationChance=0.1,
elitism=T,
monitorFunc=NULL, evalFunc=evaluate3,
showSettings=FALSE, verbose=FALSE)
plot(genalg4_labyrinth)
plot(genalg4_labyrinth)
genalg4_labyrinth$best
genalg4_labyrinth <- rbga(stringMin=vMin, stringMax=vMax,
suggestions=NULL,
popSize=lab_size*10, iters=lab_size*30,
mutationChance=0.2,
elitism=T,
monitorFunc=NULL, evalFunc=evaluate3,
showSettings=FALSE, verbose=FALSE)
plot(genalg4_labyrinth)
genalg4_labyrinth$best
genalg4_labyrinth <- rbga(stringMin=vMin, stringMax=vMax,
suggestions=NULL,
popSize=lab_size*15, iters=lab_size*30,
mutationChance=0.2,
elitism=T,
monitorFunc=NULL, evalFunc=evaluate3,
showSettings=FALSE, verbose=FALSE)
genalg4_labyrinth$best
pheatmap(lab15, cellwidth = 15,
cellheight = 15,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
pheatmap(lab_xx, cellwidth = 15,
cellheight = 15,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
dim(lab_xx) <- c(22,22)
pheatmap(lab_xx, cellwidth = 15,
cellheight = 15,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
genalg4_labyrinth <- rbga(stringMin=vMin, stringMax=vMax,
suggestions=NULL,
popSize=lab_size*30, iters=lab_size*30,
mutationChance=0.2,
elitism=T,
monitorFunc=NULL, evalFunc=evaluate3,
showSettings=FALSE, verbose=FALSE)
genalg4_labyrinth$best
genalg4_labyrinth <- rbga(stringMin=vMin, stringMax=vMax,
suggestions=NULL,
popSize=lab_size*10, iters=lab_size*10,
mutationChance=0.1,
elitism=T,
monitorFunc=NULL, evalFunc=evaluate3,
showSettings=FALSE, verbose=FALSE)
genalg4_labyrinth$best
vMin
pheatmap(labyrinth, cellwidth = 15,
cellheight = 15,
cluster_row = FALSE,
cluster_col = FALSE,
color=gray.colors(2,start=1,end=0))
vMin <- rep(0.51, lab_size * 6); vMax <- rep(4.49, lab_size * 6)
genalg_labyrinth <- rbga(stringMin=vMin, stringMax=vMax,
suggestions=NULL,
popSize=200, iters=200,
mutationChance=0.1,
elitism=T,
monitorFunc=NULL, evalFunc=evaluate3,
showSettings=FALSE, verbose=FALSE)
genalg_labyrinth$best
genalg_labyrinth <- rbga(stringMin=vMin, stringMax=vMax,
suggestions=NULL,
popSize=200, iters=200,
mutationChance=0.1,
elitism=T,
monitorFunc=NULL, evalFunc=evaluate3,
showSettings=FALSE, verbose=FALSE)
genalg_labyrinth$best
rbga_results
# or create matrix with results for different popsize and iterations number
{
rbga_results <- (matrix(data = NA, nrow = lab_size, ncol = 6))
colnames(rbga_results) <- c("pop&iter", "user", "system", "time", '5', '6' )
for (i in 1:lab_size) {
rbga_results[i,] <- c(i * lab_size, system.time(
rbga(stringMin=vMin, stringMax=vMax,
suggestions=NULL,
popSize=lab_size*i, iters=lab_size*i,
mutationChance=0.1,
elitism=T,
monitorFunc=NULL, evalFunc=evaluate3,
showSettings=FALSE, verbose=FALSE)
))
}
rbga_results
}
# plot the results
plot(rbga_results[,c(1,4)],
type = "b",
col = "red",
main = "Genethic algorithm efficiency according to population size and iterations number",
xlab = "Population size and iterations number for rbga method"
)
{
pdf(file = "genalg_results_lab15.pdf",
#      width=6,
height=4,
paper='a4r',
pagecentre = T,
onefile = F)
plot(rbga_results[,c(1,4)],
type = "b",
col = "red",
main = "Genalg efficiency according to population size and iterations number",
xlab = "Population size and iterations number for rbga method"
)
dev.off()
}
